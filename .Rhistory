PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_BG_PWM.txt", "PWM From BG ")
PLOT.WEIGHTS.FOR.EACH.BASE <- function(dataFile,Main){
  pwm_data<- scan(file= dataFile, sep =",", quiet = TRUE)
  pwm_matrix <- matrix(pwm_data, ncol =4, byrow = TRUE)
  plot(pwm_matrix[,1],col = 'red', lwd =3, type = 'l', ylab= 'weight', xlab= 'position',ylim= c(-2,1),main = Main)
lines(pwm_matrix[,2], col = 'blue', lwd =3)
lines(pwm_matrix[,3], col = 'green', lwd =3)
lines(pwm_matrix[,4], col = 'grey', lwd =3)
legend('bottomright', legend = c("a","c","g","t"), lty=1:4,col = c("red", "blue","green", "grey"), pt.bg = 'orange', pt.lwd =3, lwd =2, bg= 'khaki', ncol =2)
}#PLOT.WEIGHTS.FOR.EACH.BASE#
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_Real_PWM.txt", "PWM From Real Tags")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_BG_PWM.txt", "PWM From BG ")
PLOT.WEIGHTS.FOR.EACH.BASE <- function(dataFile,Main){
  pwm_data<- scan(file= dataFile, sep =",", quiet = TRUE)
  pwm_matrix <- matrix(pwm_data, ncol =4, byrow = TRUE)
  plot(pwm_matrix[,1],col = 'red', lwd =3, type = 'l', ylab= 'weight', xlab= 'position',ylim= c(-2,1),main = Main)
lines(pwm_matrix[,2], col = 'blue', lwd =3)
lines(pwm_matrix[,3], col = 'green', lwd =3)
lines(pwm_matrix[,4], col = 'grey', lwd =3)
legend('topright', legend = c("a","c","g","t"), lty=1:4,col = c("red", "blue","green", "grey"), pt.bg = 'orange', pt.lwd =3, lwd =2, bg= 'khaki', ncol =2)
}#PLOT.WEIGHTS.FOR.EACH.BASE#
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_Real_PWM.txt", "PWM From Real Tags")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_BG_PWM.txt", "PWM From BG ")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_Real_PWM.txt", "Gm12878\nPWM From Real Tags")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_BG_PWM.txt", "Gm12878\nPWM From BG ")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_Real_PWM.txt", "Gm12878\nPWM From Real Tags")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_BG_PWM.txt", "Gm12878\nPWM From BG ")
data_file <- "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/scores.txt"
data      <- scan(file = data_file)
hist(data, breaks =70, col= 'grey', xlab='scores', ylab='frequency', main='Gm12878')
data_file <- "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/scores.txt"
data      <- scan(file = data_file)
hist(data, breaks =70, col= 'grey', xlab='scores', ylab='frequency', main='Gm12878')
data_file <- "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/scores.txt"
data      <- scan(file = data_file)
hist(data, breaks =70, col= 'grey', xlab='scores', ylab='frequency', main='Gm12878')
data_file <- "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/scores.txt"
data      <- scan(file = data_file)
hist(data, breaks =70, col= 'grey', xlab='scores', ylab='frequency', main='Gm12878')
data_file <- "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/scores.txt"
data      <- scan(file = data_file)
hist(data, breaks =70, col= 'grey', xlab='scores', ylab='frequency', main='Gm12878')
data_file <- "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/scores.txt"
data      <- scan(file = data_file)
hist(data, breaks =70, col= 'grey', xlab='scores', ylab='frequency', main='Gm12878')
data      <- scan(file = data_file)
data_file <- "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/scores.txt"
data      <- scan(file = data_file)
hist(data, breaks =70, col= 'grey', xlab='scores', ylab='frequency', main='Gm12878')
data_file <- "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/scores.txt"
data      <- scan(file = data_file)
hist(data, breaks =70, col= 'grey', xlab='scores', ylab='frequency', main='Gm12878')
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_Real_PWM.txt", "Gm12878\nPWM From Real Tags")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_BG_PWM.txt", "Gm12878\nPWM From BG ")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/wgEncodeUwDnaseGm12878AlnRep1_chr22_biasness_scores_Real_PWM.txt", "Gm12878\nPWM From Real Tags")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/wgEncodeUwDnaseGm12878AlnRep1_chr22_biasness_scores_BG_PWM.txt.txt", "Gm12878\nPWM From BG ")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/wgEncodeUwDnaseGm12878AlnRep1_chr22_biasness_scores_BG_PWM.txt", "Gm12878\nPWM From BG ")
3+4
File.Data <- "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/scores.txt"
Data <- scan(File.Data)
hist(Data, breaks = 100, col = 'grey', ylab = 'frequency', xlab= 'scores', main = "Gm12878\n biasness scores for seqs with offset=5")
par(mfrow= c(1,2))
hist(Data, breaks = 100, col = 'grey', ylab = 'frequency', xlab= 'scores', main = "Gm12878\n biasness scores for seqs with offset=5")
hist(Data, breaks = 100, col = 'grey', ylab = 'frequency', xlab= 'scores', main = "Gm12878\n biasness scores for seqs with offset=5", prob= TRUE)
hist(Data, breaks = 100, col = 'grey', ylab = 'frequency', xlab= 'scores', main = "Gm12878\n biasness scores for seqs with offset=5", prob= TRUE)
hotspot_lengths_chrwize <- "/nfs/th_group/hk3/Hotspot_Analysis/H1hesc/wgEncodeUwDnaseH1hescAlnRep1_chr22_modified_sorted.bed-both-passes/lengths_of_chr22_hotspots_chrwize.txt"
hotspot_lengths_genomewize <- "/nfs/users/nfs_h/hk3/Hotspot/hotspot-ptih/pipeline-scripts/test/wgEncodeUwDnaseH1hescAlnRep1_modified_for_hotspot_sorted.bed-both-passes/length_of_chr22_hotshpts.txt"
data_hotspot_length_chrwize <- scan(hotspot_lengths_chrwize)
data_hotspot_lengths_genomewize <- scan(hotspot_lengths_genomewize)
length(which(data_hotspot_length_chrwize >= 200))
length(which(data_hotspot_lengths_genomewize >= 200))
15547/19752
6430/13595
mean(data_hotspot_length_chrwize)
sd(data_hotspot_length_chrwize)
mean(data_hotspot_lengths_genomewize)
sd(data_hotspot_lengths_genomewize)
hist(data_hotspot_lengths_genomewize, breaks =100)
hist(data_hotspot_lengths_genomewize, breaks =70)
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wize", col = 'grey', xlab = 'length of hotspots')
encod_hotspot_lengths <- "/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc/H1hesch_Encode_Hotspot_Lengths.txt"
data_encod_hotspot_lengths <- scan(encod_hotspot_lengths)
length(which(data_encod_hotspot_lengths >= 200))
4014/9746
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
sum(data_encod_hotspot_lengths)
sum(data_hotspot_length_chrwize)
sum(data_hotspot_lengths_genomewize)
par(mfrow = c(1,3))
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
2427854/5373067
2427854/2672923
sum(data_encod_hotspot_lengths)
2427854/51304566
mean(data_encod_hotspot_lengths)
sd(data_encod_hotspot_lengths)
sum(data_hotspot_lengths_genomewize)
2672923/51304566
mean(data_hotspot_lengths_genomewize)
sd(data_hotspot_lengths_genomewize)
sum(data_hotspot_length_chrwize)
5373067/51304566
mean(data_hotspot_length_chrwize)
sd(data_hotspot_length_chrwize)
length(data_encod_hotspot_lengths)
length(data_hotspot_lengths_genomewize)
length(data_hotspot_length_chrwize)
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots')
abline(v=200, col = 'red')
abline(v=100, col = 'red')
abline(v=300, col = 'red')
abline(v=400, col = 'red')
par(mfrow= c(1,3))
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wize", col = 'grey', xlab = 'length of hotspots')
42016129-42018051
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
par(mfrow= c(1,3))
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wide", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =seq(0,5000,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =seq(0,5000,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =seq(0,5500,by=100),main = "length of H1hesc hotspot obtained from Encode", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =seq(0,5000,by=100),main = "length of H1hesc hotspot obtained from Encode", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_lengths_genomewize, breaks =seq(0,5000,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =seq(0,5000,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots')
max(data_encod_hotspot_lengths)
hist(data_encod_hotspot_lengths, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained from Encode", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_lengths_genomewize, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_length_chrwize, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained chr-wide", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained from Encode", col = 'grey', xlab = 'length of hotspots',ylim=c(0,7000))
par(mfrow=c(1,3))
hist(data_encod_hotspot_lengths, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained from Encode", col = 'grey', xlab = 'length of hotspots',ylim=c(0,7000))
hist(data_hotspot_lengths_genomewize, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots',ylim=c(0,7000))
hist(data_hotspot_length_chrwize, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained chr-wide", col = 'grey', xlab = 'length of hotspots',ylim=c(0,7000))
