qplot(end-start, score, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom = c("point", "smooth"))
qplot(end-start, score, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom = c("point", "smooth"), xlab = "length of PolII braod peaks")
qplot(end-start, score, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom = c("point", "smooth"), xlab = "lengths of PolII braod peaks", main = "score vs length of peaks in H1hescPol2V0416102PkRep1")
Max <- max(H1hescPol2V0416102PkRep1.chr22.broadPeak$end)
Max
Min <- min(H1hescPol2V0416102PkRep1.chr22.broadPeak$start)
Min
Sum <- sum(H1hescPol2V0416102PkRep1.chr22.broadPeak$end - H1hescPol2V0416102PkRep1.chr22.broadPeak$start)
Sum
Coverage <- Sum/(Max-Min)
Coverage
round(Coverage*100,0)
?save
qplot(end-start, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom =  "histogram")
qplot(end-start, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom =  "histogram", binwidth = 100)
qplot(end-start, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom =  "histogram", binwidth = 100, colour = "blue")
qplot(score, thickStart, data = H1hescPol2V0416102PkRep1.chr22.broadPeak)
qplot(end-start, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom =  "histogram", binwidth = 100)
qplot(end-start, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom =  "histogram", binwidth = 100, fill = "blue")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100)
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "blue")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "blue", fill = "red")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white", xlab = "lengths")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white", xlab = "lengths")+ scale_x_continous(name = "lengths")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white", xlab = "lengths")+ scale_x_continuous(name = "lengths")
pol_II_lengths <- ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white", xlab = "lengths")+ scale_x_continuous(name = "lengths")
pol_II_lengths + opts(title = "Pol II")
E_df <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc/wgEncodeUwDnaseH1hescHotspotsRep1.bed")
A_df <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc/group_A_hotspots.bed")
B_df <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc/group_B_hotspots.bed")
E_Lengths <- ggplot(E_df, aes(x= end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white")+scale_x_continuous("name = lengths")
E_Lengths
E_Lengths <- ggplot(E_df, aes(x= end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white")+scale_x_continuous("name = lengths")+ opts(title = "lengths of E hotspots")
A_Lengths <- ggplot(A_df, aes(x= end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white")+scale_x_continuous("name = lengths")+ opts(title = "lengths of A hotspots")
A_Lengths
B_Lengths <- ggplot(B_df, aes(x= end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white")+scale_x_continuous("name = lengths")+ opts(title = "lengths of B hotspots")
B_Lengths
multiplot(pol_II_lengths, E_Lengths, A_Lengths, B_Lengths, cols = 2)
library(ggplot2)
multiplot(pol_II_lengths, E_Lengths, A_Lengths, B_Lengths, cols = 2)
multiplot <- function(..., plotlist=NULL, cols) {
    require(grid)
    # Make a list from the ... arguments and plotlist
    plots <- c(list(...), plotlist)
    numPlots = length(plots)
    # Make the panel
    plotCols = cols                          # Number of columns of plots
    plotRows = ceiling(numPlots/plotCols) # Number of rows needed, calculated from # of cols
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(plotRows, plotCols)))
    vplayout <- function(x, y)
        viewport(layout.pos.row = x, layout.pos.col = y)
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
        curRow = ceiling(i/plotCols)
        curCol = (i-1) %% plotCols + 1
        print(plots[[i]], vp = vplayout(curRow, curCol ))
    }
}
multiplot(pol_II_lengths, E_Lengths, A_Lengths, B_Lengths, cols = 2)
multiplot(pol_II_lengths+opts(title = "Pol II"), E_Lengths, A_Lengths, B_Lengths, cols = 2)
multiplot(pol_II_lengths+opts(title = "Lengths of Pol II"), E_Lengths, A_Lengths, B_Lengths, cols = 2)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_df,A_df, B_df, binWidth = 10000, "H1hesc")
distribution.of.hotspost(E_df,A_df, B_df, 10000, "H1hesc")
distribution.of.hotspost(E_df,A_df, B_df, 100000, "H1hesc")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_df,A_df, B_df, 100000, "H1hesc")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_df,A_df, B_df, 100000, "H1hesc")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_df,A_df, B_df, 100000, "H1hesc")
choose(100,4)
choose(50000000,30000000)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
Tabel <- get.table("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562AlnRep1_chr22_biasness_scores_Real_PWM.txt")
Tabel <- get.table("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562AlnRep1_chr22_biasness_scores_Real_PWM.txt", ",")
dim(Table)
Table <- get.table("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562AlnRep1_chr22_biasness_scores_Real_PWM.txt", ",")
dim(Table)
Table
Table[1,1]
nrows(Table)
nrow(Table)
ncol(Table)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
dim(PWM)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
PWM <- draw.pwm(Table)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
PWM
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
PWM
PWM <- draw.pwm(Table)
dim(PWM)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
dim(PWM)
M <- melt(pwm,varnames = c("nt", "pos")), aes(x= pos,y= value, label = nt)
M <- melt(PWM,varnames = c("nt", "pos")), aes(x= pos,y= value, label = nt))
M <- melt(PWM,varnames = c("nt", "pos"))
M
PWM
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
PWM
M <- melt(PWM,varnames = c("nt", "pos"))
M
p<- ggplot(M, aes(x=pos, y = value,label= nt) )
p+geom_abline( aes(colour= factor(nt)) )
qplot(x=pos, y= value, label = nt, data = M)
p+geom_abline( aes(slope=0) , colour= "grey", size=2 )
p+geom_abline( aes(slope=0) , colour= "grey", size=2 )+ geom_text(aes(colour=factor(nt)),size=8)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
PWM
TABLE_BACKGROUND <- get.table("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562AlnRep1_chr22_biasness_scores_BG_PWM.txt")
TABLE_BACKGROUND <- get.table("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562AlnRep1_chr22_biasness_scores_BG_PWM.txt",",")
PWM_BG <- draw.pwm(TABLE_BACKGROUND)
PWM_BG
PWM_BG+ylim(-1,1)
PWM
PWM +ylim(-1, 0.5)
PWM
PWM +ylim(-1.2, 0.5)
PWM_BG+ylim(-1.2, 0.5)
PWM_BG+ylim(-1.2, 0.5)+main("Main")
multiplot(bp + opts(title="Plant growth"))
bp + opts(title="Plant growth")
multiplot(PWM +ylim(-1.2, 0.5)+ opts(title="Biased Model"), PWM_BG+ylim(-1.2, 0.5) + opts(title= "Background Model"), cols=2)
multiplot(PWM +ylim(-1.2, 0.5)+ opts(title="Biased Model")+ scale_y_continuous(name="Log relative frequency"), PWM_BG+ylim(-1.2, 0.5) + opts(title= "Background Model")+  scale_y_continuous(name="Log relative frequency"), cols=2)
PWM_BG <- PWM_BG+ylim(-1.2, 0.5)+ scale_y_continuous(name="Log relative frequency")
PWM_BG <- PWM_BG+ylim(-1.2, 0.5)+ scale_y_continuous(name="Log relative frequency")+ opts(title= "Background Model")
PWM +ylim(-1.2, 0.5)+ scale_y_continuous(name="Log relative frequency")+ opts(title="Biased Model")
PWM <-PWM +ylim(-1.2, 0.5)+ scale_y_continuous(name="Log relative frequency")+ opts(title="Biased Model")
multiplot(PWM, PWM_BG, cols=2)
PWM<-PWM +scale_y_continuous(name="Log relative frequency", limits=c(-1.2,0.5))+ opts(title="Biased Model")
PWM_BG <- PWM_BG+ scale_y_continuous(name="Log relative frequency", limits = c(-1.2,05))+ opts(title= "Background Model")
multiplot(PWM, PWM_BG, cols=2)
PWM_BG <- PWM_BG+ scale_y_continuous(name="Log relative frequency", limits = c(-1.2,0.5))+ opts(title= "Background Model")
multiplot(PWM, PWM_BG, cols=2)
PWM_BG <- PWM_BG+ scale_y_continuous(name="Log relative frequency", limits = c(-1.2,0.5))+ opts(title= "Background Model",legend.position="none")
PWM_BG <- PWM_BG+ scale_y_continuous(name="Log relative frequency", limits = c(-1.2,0.5))+ opts(title= "Background Model",legend.position="none")
multiplot(PWM, PWM_BG, cols=2)
distribution.of.hotspost(E_df,A_df, B_df, 10000, "H1hesc")
distribution.of.hotspost(E_df,A_df, B_df, 1000, "H1hesc")
distribution.of.hotspost(E_df,A_df, B_df, 100000, "H1hesc")
round( (405785/2462469)*100, 0 )
round( (1424238/2462469)*100, 0 )
round( (632446/2462469)*100, 0 )
round( (297999/2156936)*100, 0 )
round( (1532024/2156936)*100, 0 )
round( (326913/2156936)*100, 0 )
round( (560729/2565766)*100, 0 )
round( (1269294/2565766)*100, 0 )
round( (735743/2565766)*100, 0 )
E_df_Long <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc/wgEncodeUwDnaseH1hescHotspotsRep1_not_shorter_than_200.bed")
distribution.of.hotspost(E_df_Long,A_df, B_df, 10000, "H1hesc")
distribution.of.hotspost(E_df_Long,A_df, B_df, 1000, "H1hesc")
distribution.of.hotspost(E_df_Long,A_df, B_df, 10000, "H1hesc")
distribution.of.hotspost(E_df_Long,A_df, B_df, 100000, "H1hesc")
library(plyr)
library(ggplot2)
library(reshape2)
k.mer.as.data.frame <- function(RealKMersFile, BgKmersFile){
  tab5rows  <- read.table(RealKMersFile, nrows = 5)
  classes   <- sapply(tab5rows,class)
  Data.Real <- read.table(RealKMersFile, comment.char = "", colClasses = classes)
  tab5rowsBG <- read.table(BgKmersFile, nrows =5)
  classesBG  <- sapply(tab5rowsBG, class)
  Data.Bg <- read.table(BgKmersFile, comment.char = "", colClasses = classesBG)
  Bg.Freq <- Data.Bg[,2]
  Combind.Data <- cbind(Data.Real, Bg.Freq)
  
  colNames <- c("kmer","Real_Tags_Frequency", "BG_Tags_Frequency")
  colnames(Combind.Data) <- colNames
  
  data.as.df <- as.data.frame(Combind.Data)
  data.as.df
}#k.mer.as.data.frame#
Gm12878<- k.mer.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt")
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_line()
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_points()
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point()
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point()+xlim(0,3000)
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point()+xlim(0,3000)+opts(xlab="Real Tags")
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point()+xlim(0,3000)+xlab(Real Tags)
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point()+xlim(0,3000)+xlab("Real Tags")
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point()+xlim(0,3000)+xlab("Real Tags")+ylab("background")
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency, colour='red'))+geom_point()+xlim(0,3000)+xlab("Real Tags")+ylab("background")
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency, colour='red'))+geom_point()+xlim(0,3000)+xlab("Real Tags")+ylab("background")+smooth()
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,3000)+xlab("Real Tags")+ylab("background")
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,3000)+xlab("Real Tags")+ylab("background")+geom_smooth()
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,3000)+xlab("Real Tags")+ylab("background")+geom_smooth()+opst(title="8-mers in Gm12878 vs BG")
ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,3000)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title="8-mers in Gm12878 vs BG")
Gm12878 = ggplot(Gm12878, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,3000)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title="8-mers in Gm12878 vs BG")
H1hesc <- k.mer.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_bg.txt")
ggplot(H1hesc, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,3000)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title="8-mers in H1hesc vs BG")
ggplot(H1hesc, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,2000)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title="8-mers in H1hesc vs BG")
H1hesc_Plots <- ggplot(H1hesc, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,2000)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title="8-mers in H1hesc vs BG")
Gm12878
H1hesc_Plots
K562 <- k.mer.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_bg.txt")
ggplot(K562, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,2000)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title="8-mers in K562 vs BG")
ggplot(K562, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,3000)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title="8-mers in K562 vs BG")
K562_Plots <-ggplot(K562, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,3000)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title="8-mers in K562 vs BG")
multiplot <- function(..., plotlist=NULL, cols) {
    require(grid)
    # Make a list from the ... arguments and plotlist
    plots <- c(list(...), plotlist)
    numPlots = length(plots)
    # Make the panel
    plotCols = cols                          # Number of columns of plots
    plotRows = ceiling(numPlots/plotCols) # Number of rows needed, calculated from # of cols
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(plotRows, plotCols)))
    vplayout <- function(x, y)
        viewport(layout.pos.row = x, layout.pos.col = y)
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
        curRow = ceiling(i/plotCols)
        curCol = (i-1) %% plotCols + 1
        print(plots[[i]], vp = vplayout(curRow, curCol ))
    }
  }#multiplot#
multiplot(Gm12878, H1hesc_Plots, K562_Plots , cols=3)
Gm12878_Plots <- Gm12878
K562 <- k.mer.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt")
Gm12878_greater_than_500_indices <- whihc(Gm1287$Real_Tags_Frequency > 500)
Gm12878_greater_than_500_indices <- which(Gm1287$Real_Tags_Frequency > 500)
K562 <- k.mer.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_bg.txt")
Gm12878 <- k.mer.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt")
Gm12878_greater_than_500_indices <- which(Gm1287$Real_Tags_Frequency > 500)
Gm12878_greater_than_500_indices <- which(Gm12878$Real_Tags_Frequency > 500)
Gm12878_greater_than_500_indices
Gm12878_bg_less_than_500_indices <- which(Gm12878$BG_Tags_Frequency > 500)
?common
?intersect
Gm12878_intersect <- intersect(Gm12878_greater_than_500_indices, Gm12878_bg_less_than_500_indices)
Gm12878_intersect
Gm12878[Gm12878_intersect,]
Gm12878_bg_less_than_500_indices <- which(Gm12878$BG_Tags_Frequency < 500)
Gm12878_intersect <- intersect(Gm12878_greater_than_500_indices, Gm12878_bg_less_than_500_indices)
Gm12878[Gm12878_intersect,]
K562_greater_than_500_indices <- which(K562$Real_Tags_Frequency > 500)
K562_bg_less_than_500_indices <- which(K562$BG_Tags_Frequency < 500)
K562_intersect <- intersect(K562_greater_than_500_indices, K562_bg_less_than_500_indices)
K562[K562_intersect,]
H1hesc_greater_than_500_indices <- which(H1hesc$Real_Tags_Frequency > 500)
H1hesc_bg_less_than_500_indices <- which(H1hesc$BG_Tags_Frequency < 500)
H1hesc_intersect <- intersect(H1hesc_greater_than_500_indices, H1hesc_bg_less_than_500_indices)
H1hesc[H1hesc_intersect,]
Gm12878_over_represented_8_mers = Gm12878[Gm12878_intersect,1]
Gm12878_over_represented_8_mers
length(Gm12878_over_represented_8_mers)
H1hesc_over_represented_8_mers = H1hesc[H1hesc_intersect,1]
K562_over_represented_8_mers = K562[K562_intersect,1]
Gm12878_and_K562 = intersect(Gm12878_over_represented_8_mers,K562_over_represented_8_mers)
Gm12878_and_K562
Gm12878_and_H1hesc = intersect(Gm12878_over_represented_8_mers,H1hesc_over_represented_8_mers)
Gm12878_and_H1hesc
K562_and_H1hesc = intersect(K562_over_represented_8_mers,H1hesc_over_represented_8_mers)
K562_and_H1hesc
all  = intersect( intersect(K562_and_H1hesc, Gm12878_and_H1hesc), Gm12878_and_K562)
all
source("some_handy_functions.r")
plot.k.mers.frequency <- function(RealTagFreqFile, BgTagFreqFile, cellType){
  df    <- k.mer.as.data.frame(RealTagFreqFile, BgTagFreqFile)
  Max   <- max( df$Real_Tags_Frequency, df$BG_Tags_Frequency)
  Title <- paste("k-mers distribution: ", cyllType, "vs BG", sep=" ")
  ggplot(df, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,Max)+ylim(0,Max)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title=Title)
}#plot.k.mers.frequency#
plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt", "Gm12878")
plot.k.mers.frequency <- function(RealTagFreqFile, BgTagFreqFile, cellType){
  df    <- k.mer.as.data.frame(RealTagFreqFile, BgTagFreqFile)
  Max   <- max( df$Real_Tags_Frequency, df$BG_Tags_Frequency)
  Title <- paste("k-mers distribution: ", cellType, "vs BG", sep=" ")
  ggplot(df, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,Max)+ylim(0,Max)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title=Title)
}#plot.k.mers.frequency#
plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt", "Gm12878")
plot.k.mers.frequency <- function(RealTagFreqFile, BgTagFreqFile, cellType){
  df    <- k.mer.as.data.frame(RealTagFreqFile, BgTagFreqFile)
  Max   <- max( df$Real_Tags_Frequency, df$BG_Tags_Frequency)
  Title <- paste("k-mers distribution: ", cellType, "vs BG", sep=" ")
  ggplot(df, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,Max)+ylim(0,Max)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title=Title)
}#plot.k.mers.frequency#
plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt", "Gm12878")
plot.k.mers.frequency <- function(RealTagFreqFile, BgTagFreqFile, cellType){
  df    <- k.mer.as.data.frame(RealTagFreqFile, BgTagFreqFile)
  Max   <- max( df$Real_Tags_Frequency, df$BG_Tags_Frequency)
  Title <- paste("k-mers distribution: ", cellType, "vs BG", sep=" ")
  Plot <-ggplot(df, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,Max)+ylim(0,Max)+xlab("Real Tags")+ylab("background")+geom_smooth()+opts(title=Title)
  Plot
}#plot.k.mers.frequency#
plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt", "Gm12878")
Gm12878_RepeatMasked_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt", "Gm12878")
K562_RepeatMasked_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_bg.txt", "K562")
K562_RepeatMasked_Plot
H1hesc_RepeatMasked_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_bg.txt", "H1hesc")
H1hesc_RepeatMasked_Plot
multiplot(Gm12878_RepeatMasked_Plot, K562_RepeatMasked_Plot, H1hesc_RepeatMasked_Plot, cols=3)
Gm12878_RepeatMasked <-k.mer.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt")
Gm1287_Indices = which(Gm12878_RepeatMasked$Real_Tags_Frequency >350)
Gm1287_Indices
Gm1287_Indices = which(Gm12878_RepeatMasked$Real_Tags_Frequency >380)
Gm1287_Indices
Gm12878_RepeatMasked[Gm1287_Indices,]
K562_RepeatMasked <-k.mer.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_bg.txt")
K562_Indices = which(K562_RepeatMasked$Real_Tags_Frequency >380)
K562_Indices
K562_RepeatMasked[K562_Indices,]
H1hesc_RepeatMasked <-k.mer.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_bg.txt")
H1hesc_Indices = which(H1hesc_RepeatMasked$Real_Tags_Frequency >380)
H1hesc_RepeatMasked[H1hesc_Indices,]
H1hesc_RepeatMasked_6_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_bg.txt", "H1hesc")
H1hesc_RepeatMasked_6_Mers_Plot
K562_RepeatMasked_6_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_bg.txt", "K562")
K562_RepeatMasked_6_Mers_Plot
Gm12878_RepeatMasked_6_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt", "Gm12878")
Gm12878_RepeatMasked_6_Mers_Plot
mulitplot(Gm12878_RepeatMasked_6_Mers_Plot, K562_RepeatMasked_6_Mers_Plot, H1hesc_RepeatMasked_6_Mers_Plot, cols=1)
multiplot(Gm12878_RepeatMasked_6_Mers_Plot, K562_RepeatMasked_6_Mers_Plot, H1hesc_RepeatMasked_6_Mers_Plot, cols=1)
plot.k.mers.frequency <- function(RealTagFreqFile, BgTagFreqFile, cellType){
  df    <- k.mer.as.data.frame(RealTagFreqFile, BgTagFreqFile)
  Max   <- max( df$Real_Tags_Frequency, df$BG_Tags_Frequency)
  Title <- paste("k-mers distribution: ", cellType, "vs BG", sep=" ")
  Plot <-ggplot(df, aes(x=Real_Tags_Frequency,y=BG_Tags_Frequency))+geom_point(shape=1)+xlim(0,Max)+ylim(0,Max)+xlab("Real Tags")+ylab("background")+geom_smooth(method=lm)+opts(title=Title)
  Plot
}#plot.k.mers.frequency#
Gm12878_RepeatMasked_6_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt", "Gm12878")
Gm12878_RepeatMasked_6_Mers_Plot
H1hesc_RepeatMasked_6_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_bg.txt", "H1hesc")
H1hesc_RepeatMasked_6_Mers_Plot
K562_RepeatMasked_6_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_bg.txt", "K562")
K562_RepeatMasked_6_Mers_Plot
multiplot(Gm12878_RepeatMasked_6_Mers_Plot, K562_RepeatMasked_6_Mers_Plot, H1hesc_RepeatMasked_6_Mers_Plot, cols=1)
multiplot(Gm12878_RepeatMasked_6_Mers_Plot, K562_RepeatMasked_6_Mers_Plot, H1hesc_RepeatMasked_6_Mers_Plot, cols=3)
Gm12878_RepeatMasked_8_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analyis/k_mers_counts_bg.txt", "Gm12878")
Gm12878_RepeatMasked_8_Mers_Plot
H1hesc_RepeatMasked_8_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_bg.txt", "H1hesc")
H1hesc_RepeatMasked_8_Mers_Plot
K562_RepeatMasked_8_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_bg.txt", "K562")
K562_RepeatMasked_8_Mers_Plot
K562_RepeatMasked_8_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analyis/k_mers_counts_bg.txt", "K562")
K562_RepeatMasked_8_Mers_Plot
H1hesc_RepeatMasked_8_Mers_Plot <- plot.k.mers.frequency("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_real.txt", "/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analyis/k_mers_counts_bg.txt", "H1hesc")
H1hesc_RepeatMasked_8_Mers_Plot
Gm12878_RepeatMasked_8_Mers_Plot
K562_RepeatMasked_8_Mers_Plot
mulitplot(Gm12878_RepeatMasked_8_Mers_Plot, K562_RepeatMasked_8_Mers_Plot, H1hesc_RepeatMasked_8_Mers_Plot, cols =3)
multiplot(Gm12878_RepeatMasked_8_Mers_Plot, K562_RepeatMasked_8_Mers_Plot, H1hesc_RepeatMasked_8_Mers_Plot, cols =3)
scoure("some_handy_functions.r")
source("some_handy_functions.r")
density_wl_1000_sz_100_DF <- density.file.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analysis/density_wl_1000_sz_100.txt")
qplot(A,C, data = density_wl_1000_sz_100_DF, geom=c("points","smooht"), method="lm")
qplot(A,C, data = density_wl_1000_sz_100_DF, geom=c("point","smooht"), method="lm")
qplot(A,C, data = density_wl_1000_sz_100_DF, geom=c("point","smooth"), method="lm")
qplot(A,C, data = density_wl_1000_sz_100_DF, geom=c("point","smooth"), method="lm",xlab="group_A tags", ylab="all tags")
print(qplot(A,C, data = density_wl_1000_sz_100_DF, geom=c("point","smooth"), method="lm",xlab="group_A tags", ylab="all tags"))
print(qplot(B,C, data = density_wl_1000_sz_100_DF, geom=c("point","smooth"), method="lm",xlab="group_B tags", ylab="all tags"))
print(qplot(B,A, data = density_wl_1000_sz_100_DF, geom=c("point","smooth"), method="lm",xlab="group_B tags", ylab="group_A tags"))
ggplot(dat, aes(x=xvar, y=yvar)) +
    geom_point(shape=1) +    # Use hollow circles
    geom_smooth() 
ggplot(density_wl_1000_sz_100_DF, aes(x=A,y=C))+geom_point(shape=1)+geom_smooth()
ggplot(density_wl_1000_sz_100_DF, aes(x=A,y=C))+geom_point(shape=1)+geom_smooth(method=lm)
ggplot(density_wl_1000_sz_100_DF, aes(x=A,y=C))+geom_point(shape=2)+geom_smooth(method=lm)
ggplot(density_wl_1000_sz_100_DF, aes(x=A,y=C))+geom_point(shape="dot")+geom_smooth(method=lm)
ggplot(density_wl_1000_sz_100_DF, aes(x=A,y=C))+geom_point(shape="A")+geom_smooth(method=lm)
ggplot(density_wl_1000_sz_100_DF, aes(x=A,y=C))+geom_point(shape=".")+geom_smooth(method=lm)
47199429-47199430
test = seq(1,1000,by=1)
test[1]
test[5]
test[5-10]
test[5,10]
test = rnorm(1000)
test[1]
x= seq(2,10)
test[x]
test[2]
test[3]
test[10]
sub_A_indices = seq(1,1000)
from_to = seq(1,1000)
sub_A = density_wl_1000_sz_100_DF$A[from_to]
sub_C = density_wl_1000_sz_100_DF$C[from_to]
plot(sub_A, sub_C)
from_to = seq(1,150000)
sub_A = density_wl_1000_sz_100_DF$A[from_to]
sub_C = density_wl_1000_sz_100_DF$C[from_to]
plot(sub_A, sub_C)
plot(sub_A,type='p', col= 'red')
plot(sub_A,type='l')
ggplot(density_wl_1000_sz_100_DF, aes(x=A,y=C))+geom_point(shape=".")+geom_smooth(method=lm)
source("some_handy_functions.r")
PLOT.WEIGHTS.FOR.EACH.BASE <- function(dataFile,Main){
  pwm_data<- scan(file= dataFile, sep =",", quiet = TRUE)
  pwm_matrix <- matrix(pwm_data, ncol =4, byrow = TRUE)
  plot(pwm_matrix[,1],col = 'red', lwd =3, type = 'l', ylab= 'weight', xlab= 'position',ylim= c(-2,1),main = Main)
lines(pwm_matrix[,2], col = 'blue', lwd =3)
lines(pwm_matrix[,3], col = 'green', lwd =3)
lines(pwm_matrix[,4], col = 'grey', lwd =3)
legend('topright', legend = c("a","c","g","t"), lty=1:4,col = c("red", "blue","green", "grey"), pt.bg = 'orange', pt.lwd =3, lwd =2, bg= 'khaki', ncol =2)
}#PLOT.WEIGHTS.FOR.EACH.BASE#
PLOT.WEIGHTS.FOR.EACH.BASE <- function(dataFile,Main){
  pwm_data<- scan(file= dataFile, sep =",", quiet = TRUE)
  pwm_matrix <- matrix(pwm_data, ncol =4, byrow = TRUE)
  plot(pwm_matrix[,1],col = 'red', lwd =3, type = 'l', ylab= 'weight', xlab= 'position',ylim= c(-2,1),main = Main)
lines(pwm_matrix[,2], col = 'blue', lwd =3)
lines(pwm_matrix[,3], col = 'green', lwd =3)
lines(pwm_matrix[,4], col = 'grey', lwd =3)
legend('topright', legend = c("a","c","g","t"), lty=1:4,col = c("red", "blue","green", "grey"), pt.bg = 'orange', pt.lwd =3, lwd =2, bg= 'khaki', ncol =2)
}#PLOT.WEIGHTS.FOR.EACH.BASE#
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/pwm_real_tags.txt", "Gm12878, Real tags from Duke")
?rectangle
?rect
rect(15,-2,35,1, col= "yellow", density=50)
par(cex=4, lwd =4, col.axis=400, col.lab=400, col.main=400, col.sub=400, fg=400, mrfow=c(2,1))
par(cex=4, lwd =4, col.axis=400, col.lab=400, col.main=400, col.sub=400, fg=400, mfrow=c(2,1))
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/pwm_real_tags.txt", "Gm12878, Real tags from Duke")
rect(15,-2,35,1, col= "yellow", density=50)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/pwm_real_tags.txt", "Gm12878, Real tags from Duke")
rect(15,-2,35,1, col= "yellow", density=10)
par(cex=4, lwd =4, col.axis=400, col.lab=400, col.main=400, col.sub=400, fg=400, mfrow=c(1,2))
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/pwm_real_tags.txt", "Gm12878, Real tags from Duke")
rect(15,-2,35,-1.8, col= "yellow", density=10)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/pwm_real_tags.txt", "Gm12878, Real tags from Duke")
par(cex=4, lwd =4, col.axis=400, col.lab=400, col.main=400, col.sub=400, fg=400, mfrow=c(1,2))
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/pwm_real_tags.txt", "Gm12878, Real tags from Duke")
rect(15,-2,35,-1.8, col= "yellow", density=50)
?rect
?text
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/pwm_shifted_tags.txt", "Gm12878, BG tags from Duke")
rect(15,-2,35,-1.8, col= "yellow", density=50)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/K562_For_Paper_Analysis/pwm_real_tags.txt", "K562, Real tags from Duke")
rect(15,-2,35,-1.8, col= "yellow", density=50)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/K562_For_Paper_Analysis/pwm_shifted_tags.txt", "K562, BG tags from Duke")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/H1hesc_For_Paper_Analysis/pwm_real_tags.txt", "H1hesc, Real tags from Duke")
rect(15,-2,35,-1.8, col= "yellow", density=50)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/Duke_DNaseI_HS/H1hesc_For_Paper_Analysis/pwm_shifted_tags.txt", "H1hesc, BG tags from Duke")
rect(15,-2,35,-1.8, col= "yellow", density=50)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analysis/pwm_real_tags.txt", "H1hesc, Real tags from UW")
rect(10,-2,46,-1.8, col= "yellow", density=50)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc_For_Paper_Analysis/pwm_shifted_tags.txt", "H1hesc, BG tags from UW")
rect(10,-2,46,-1.8, col= "yellow", density=50)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analysis/pwm_real_tags.txt", "K562, Real tags from UW")
rect(10,-2,46,-1.8, col= "yellow", density=50)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/K562_For_Paper_Analysis/pwm_shifted_tags.txt", "K562, BG tags from UW")
rect(10,-2,46,-1.8, col= "yellow", density=50)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analysis/pwm_real_tags.txt", "G,12878, Real tags from UW")
rect(10,-2,46,-1.8, col= "yellow", density=50)
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878_For_Paper_Analysis/pwm_shifted_tags.txt", "Gm12878, BG tags from UW")
rect(10,-2,46,-1.8, col= "yellow", density=50)
Gm_Duke_DF <- bed.as.data.frame("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/wgEncodeOpenChromDnaseGm12878AlnRep1_chr22_with_biasness_scores.bed")
mean(Gm_Duke_DF$score)
sd(Gm_Duke_DF$score)
max(Gm_Duke_DF$score)
min(Gm_Duke_DF$score)
ggplot(Gm_Duke_DF, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.1, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")
Gm_Duke_DF <- bed.as.data.frame("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/wgEncodeOpenChromDnaseGm12878AlnRep1_chr22_with_biasness_scores.bed")
Gm_Duke_DF <- bed.as.data.frame("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/wgEncodeOpenChromDnaseGm12878AlnRep1_chr22_with_biasness_scores.bed")
mean(Gm_Duke_DF$score)
max(Gm_Duke_DF$score)
min(Gm_Duke_DF$score)
ggplot(Gm_Duke_DF, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.1, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")
ggplot(Gm_Duke_DF, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.1, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")+ggtitle("Gm12878 from Duke, [-4,26]")
Gm_Duke_DF_10_10 <- bed.as.data.frame("/nfs/th_group/hk3/Duke_DNaseI_HS/Gm12878_For_Paper_Analysis/wgEncodeOpenChromDnaseGm12878AlnRep1_chr22_with_biasness_scores.bed")
mean(Gm_Duke_DF_10_10$score)
sd(Gm_Duke_DF_10_10$score)
max(Gm_Duke_DF_10_10$score)
min(Gm_Duke_DF_10_10$score)
ggplot(Gm_Duke_DF_10_10, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.1, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")+ggtitle("Gm12878 from Duke, [-5,10]")
Gm12878_Duke_10_10_plot = ggplot(Gm_Duke_DF_10_10, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.1, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")+ggtitle("Gm12878 from Duke, [-5,10]")
K562_Duke_DF_10_10 <- bed.as.data.frame("/nfs/th_group/hk3/Duke_DNaseI_HS/K562_For_Paper_Analysis/wgEncodeOpenChromDnaseK562AlnRep1_chr22_with_biasness_scores.bed")
ggplot(K562_Duke_DF_10_10, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.1, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")+ggtitle("K562 from Duke, [-5,10]")
ggplot(K562_Duke_DF_10_10, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.1, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")+ggtitle("K562 from Duke, [-5,5]")
Gm12878_Duke_10_10_plot = ggplot(Gm_Duke_DF_10_10, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.1, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")+ggtitle("Gm12878 from Duke, [-5,5]")
K562_Duke_10_10_plot = ggplot(K562_Duke_DF_10_10, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.1, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")+ggtitle("K562 from Duke, [-5,5]")
H1hesc_Duke_DF_10_10 <- bed.as.data.frame("/nfs/th_group/hk3/Duke_DNaseI_HS/H1hesc_For_Paper_Analysis/wgEncodeOpenChromDnaseH1hescAlnRep1_chr22_with_biasness_scores.bed")
H1hesc_Duke_10_10_plot = ggplot(H1hesc_Duke_DF_10_10, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.1, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")+ggtitle("H1hesc from Duke, [-5,5]")
H1hesc_Duke_10_10_plot
multiplots(H1hesc_Duke_10_10_plot, K562_Duke_10_10_plot, Gm12878_Duke_10_10_plot, cols=1)
multiplot(H1hesc_Duke_10_10_plot, K562_Duke_10_10_plot, Gm12878_Duke_10_10_plot, cols=1)
H1hesc_Duke_10_10_plot+xlim(c(-5,3))
H1hesc_Duke_10_10_plot+xlim(c(-5,5))
H1hesc_Duke_10_10_plot+xlim(c(-6,6))
H1hesc_Duke_10_10_plot+xlim(c(-6,6))+ylim(c(0,0.35))
multiplot(H1hesc_Duke_10_10_plot+xlim(c(-6,6))+ylim(c(0,0.35)), K562_Duke_10_10_plot+xlim(c(-6,6))+ylim(c(0,0.35)), Gm12878_Duke_10_10_plot+xlim(c(-6,6))+ylim(c(0,0.35)), cols=1)
K562_Duke_10_10_plot+xlim(c(-6,6))+ylim(c(0,0.35))
K562_Duke_10_10_plot
K562_Duke_10_10_plot+xlim(c(-6,6))
K562_Duke_10_10_plot+xlim(c(-6,6))+ylim(c(0,0.35))
K562_Duke_10_10_plot+xlim(c(-6,6))+ylim(c(0,0.4))
multiplot(H1hesc_Duke_10_10_plot+xlim(c(-6,6))+ylim(c(0,0.4)), K562_Duke_10_10_plot+xlim(c(-6,6))+ylim(c(0,0.4)), Gm12878_Duke_10_10_plot+xlim(c(-6,6))+ylim(c(0,0.4)), cols=1)
multiplot(H1hesc_Duke_10_10_plot+ylim(c(0,0.4)), K562_Duke_10_10_plot+ylim(c(0,0.4)), Gm12878_Duke_10_10_plot+ylim(c(0,0.4)), cols=1)
Gm12878_Duke_10_10_plot = ggplot(Gm_Duke_DF_10_10, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.01, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")+ggtitle("Gm12878 from Duke, [-5,5]")
Gm12878_Duke_10_10_plot
Gm12878_Duke_10_10_plot = ggplot(Gm_Duke_DF_10_10, aes(x=score))+geom_histogram(aes(y=..density..), binwidth=0.2, fill='white', colour='black')+geom_density(alpha=.2, fill="grey")+ggtitle("Gm12878 from Duke, [-5,5]")
Gm12878_Duke_10_10_plot
507594/261400
