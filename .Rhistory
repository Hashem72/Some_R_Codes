PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_Real_PWM.txt", "Gm12878\nPWM From Real Tags")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/testing_BG_PWM.txt", "Gm12878\nPWM From BG ")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/wgEncodeUwDnaseGm12878AlnRep1_chr22_biasness_scores_Real_PWM.txt", "Gm12878\nPWM From Real Tags")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/wgEncodeUwDnaseGm12878AlnRep1_chr22_biasness_scores_BG_PWM.txt.txt", "Gm12878\nPWM From BG ")
PLOT.WEIGHTS.FOR.EACH.BASE("/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/wgEncodeUwDnaseGm12878AlnRep1_chr22_biasness_scores_BG_PWM.txt", "Gm12878\nPWM From BG ")
3+4
File.Data <- "/nfs/th_group/hk3/UW_DNaseI_HS/Gm12878/scores.txt"
Data <- scan(File.Data)
hist(Data, breaks = 100, col = 'grey', ylab = 'frequency', xlab= 'scores', main = "Gm12878\n biasness scores for seqs with offset=5")
par(mfrow= c(1,2))
hist(Data, breaks = 100, col = 'grey', ylab = 'frequency', xlab= 'scores', main = "Gm12878\n biasness scores for seqs with offset=5")
hist(Data, breaks = 100, col = 'grey', ylab = 'frequency', xlab= 'scores', main = "Gm12878\n biasness scores for seqs with offset=5", prob= TRUE)
hist(Data, breaks = 100, col = 'grey', ylab = 'frequency', xlab= 'scores', main = "Gm12878\n biasness scores for seqs with offset=5", prob= TRUE)
hotspot_lengths_chrwize <- "/nfs/th_group/hk3/Hotspot_Analysis/H1hesc/wgEncodeUwDnaseH1hescAlnRep1_chr22_modified_sorted.bed-both-passes/lengths_of_chr22_hotspots_chrwize.txt"
hotspot_lengths_genomewize <- "/nfs/users/nfs_h/hk3/Hotspot/hotspot-ptih/pipeline-scripts/test/wgEncodeUwDnaseH1hescAlnRep1_modified_for_hotspot_sorted.bed-both-passes/length_of_chr22_hotshpts.txt"
data_hotspot_length_chrwize <- scan(hotspot_lengths_chrwize)
data_hotspot_lengths_genomewize <- scan(hotspot_lengths_genomewize)
length(which(data_hotspot_length_chrwize >= 200))
length(which(data_hotspot_lengths_genomewize >= 200))
15547/19752
6430/13595
mean(data_hotspot_length_chrwize)
sd(data_hotspot_length_chrwize)
mean(data_hotspot_lengths_genomewize)
sd(data_hotspot_lengths_genomewize)
hist(data_hotspot_lengths_genomewize, breaks =100)
hist(data_hotspot_lengths_genomewize, breaks =70)
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wize", col = 'grey', xlab = 'length of hotspots')
encod_hotspot_lengths <- "/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc/H1hesch_Encode_Hotspot_Lengths.txt"
data_encod_hotspot_lengths <- scan(encod_hotspot_lengths)
length(which(data_encod_hotspot_lengths >= 200))
4014/9746
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
sum(data_encod_hotspot_lengths)
sum(data_hotspot_length_chrwize)
sum(data_hotspot_lengths_genomewize)
par(mfrow = c(1,3))
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
2427854/5373067
2427854/2672923
sum(data_encod_hotspot_lengths)
2427854/51304566
mean(data_encod_hotspot_lengths)
sd(data_encod_hotspot_lengths)
sum(data_hotspot_lengths_genomewize)
2672923/51304566
mean(data_hotspot_lengths_genomewize)
sd(data_hotspot_lengths_genomewize)
sum(data_hotspot_length_chrwize)
5373067/51304566
mean(data_hotspot_length_chrwize)
sd(data_hotspot_length_chrwize)
length(data_encod_hotspot_lengths)
length(data_hotspot_lengths_genomewize)
length(data_hotspot_length_chrwize)
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots')
abline(v=200, col = 'red')
abline(v=100, col = 'red')
abline(v=300, col = 'red')
abline(v=400, col = 'red')
par(mfrow= c(1,3))
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wize", col = 'grey', xlab = 'length of hotspots')
42016129-42018051
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wize", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
par(mfrow= c(1,3))
hist(data_encod_hotspot_lengths, breaks =70,main = "length of H1hesc hotspot obtained encode", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_length_chrwize, breaks =70,main = "length of H1hesc hotspot obtained chr-wide", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =70,main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =seq(0,5000,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots', xlim = c(0,5500), ylim = c(0,3000))
hist(data_hotspot_lengths_genomewize, breaks =seq(0,5000,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =seq(0,5500,by=100),main = "length of H1hesc hotspot obtained from Encode", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =seq(0,5000,by=100),main = "length of H1hesc hotspot obtained from Encode", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_lengths_genomewize, breaks =seq(0,5000,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =seq(0,5000,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots')
max(data_encod_hotspot_lengths)
hist(data_encod_hotspot_lengths, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained from Encode", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_lengths_genomewize, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots')
hist(data_hotspot_length_chrwize, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained chr-wide", col = 'grey', xlab = 'length of hotspots')
hist(data_encod_hotspot_lengths, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained from Encode", col = 'grey', xlab = 'length of hotspots',ylim=c(0,7000))
par(mfrow=c(1,3))
hist(data_encod_hotspot_lengths, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained from Encode", col = 'grey', xlab = 'length of hotspots',ylim=c(0,7000))
hist(data_hotspot_lengths_genomewize, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained genome-wide", col = 'grey', xlab = 'length of hotspots',ylim=c(0,7000))
hist(data_hotspot_length_chrwize, breaks =seq(0,5600,by=100),main = "length of H1hesc hotspot obtained chr-wide", col = 'grey', xlab = 'length of hotspots',ylim=c(0,7000))
library(plyr)
library(ggplot2)
library(reshape2)
?qplot
attributes(diamonds)
is.data.frame(diamonds)
dim(diamonds)
diamonds[1:10,]
X <- matrix(1:6)
X
X <- matrix(1:6, ncol = 2)
X
X <- matrix(1:6, ncol = 2, byrow= TRUE)
X
?dimnames
X <- matrix(1:6, ncol = 2, byrow= TRUE, dimnames = list(LETTERS[1:3],LETTERS[24:25]))
X
X <- matrix(1:6, ncol = 2, byrow= TRUE, dimnames = list(LETTERS[1:3],letters[24:25]))
X
X[1,2]
X[1,4]
is.matrix(X)
is.data.frame(X)
XX <- data.frame(X)
XX
is.data.frame(SS)
is.data.frame(XX)
str(XX)
attributes(wt)
p <- qplot(wt, mpg, data = mtcars)
p + geom_abline()
set.seed(1410)
dsmall<- diamonds[sample(nrow(diamonds), 100)]
nrow(diamonds)
dsmall<- diamonds[sample(nrow(diamonds), 100),]
qplot(carat, price, data = diamonds)
qplot(log(carat), log(price), data = diamonds)
qplot(carat, x*y*z, data = diamonds)
qplot(carat, price, data = dsmall, colour = color)
qplot(carat, price, data = dsmall, colour = color, shape = cut)
qplot(carat, price, data = diamonds, colour = color, shape = cut)
qplot(carat, price, data = diamonds, colour = color, shape = cut, alpha = I(1/100))
qplot(carat, price, data = diamonds, colour = color, shape = cut, alpha = I(1/50))
qplot(carat, price, data = diamonds, colour = color, shape = cut, alpha = I(1/10))
qplot(carat, price, data = diamonds, colour = color, shape = cut, alpha = I(1/5))
qplot(carat, price, data = diamonds, colour = color, shape = cut, alpha = I(1/2))
qplot(carat,  data = diamonds)
qplot(price,  data = diamonds)
qplot(carat, price, data = dsmall, geom = c("points", "smooth"))
qplot(carat, price, data = dsmall, geom = c("point", "smooth"))
qplot(carat, price, data = diamonds, geom = c("point", "smooth"))
qplot(carat, price, data = dsmall, geom = c("point", "smooth"), span = 0.2)
qplot(carat, price, data = dsmall, geom = c("point", "smooth"), span = 1)
qplot(carat, price, data = dsmall, geom = c("point", "smooth"), span = 0.8)
qplot(carat, price, data = dsmall, geom = c("point", "smooth"), span = 0.5)
qplot(carat, price, data = dsmall, geom = c("point", "smooth"), span = 0.1)
library(mgcv)
qplot(carat, price, data = dsmall, geom = c("point", "smooth"))
qplot(carat, price, data = dsmall, geom = c("point", "smooth"), method = "gam", formula = y ~ s(x))
qplot(carat, price, data = dsmall, geom = c("point", "smooth"), method = "gam", formula = y ~ s(x, bs = "cs"))
qplot(carat, price, data = diamonds, geom = c("point", "smooth"), method = "gam", formula = y ~ s(x, bs = "cs"))
library(splines)
qplot(carat, price, data = diamonds, geom = c("point", "smooth"), method = "gam", formula = y ~ ns(x,5))
qplot(color, price / carat, data diamonds, geom = "jitter", alpha = I(1 / 5))
qplot(color, price / carat, data = diamonds, geom = "jitter", alpha = I(1 / 5))
qplot(color, price / carat, data = diamonds, geom = "boxplot", alpha = I(1 / 5))
qplot(carat, data = diamonds, geom = "histogram")
qplot(carat, data = diamonds, geom = "density")
qplot(carat, data = diamonds, geom = "histogram", bandwith = 1)
qplot(carat, data = diamonds, geom = "histogram", binwidth = 1)
qplot(carat, data = diamonds, geom = "histogram", binwidth = 1, xlim = c(0,3))
qplot(carat, data = diamonds, geom = "histogram", binwidth = 0.1, xlim = c(0,3))
qplot(carat, data = diamonds, geom = "histogram", binwidth = 0.01, xlim = c(0,3))
qplot(carat, data = diamonds, geom = "density")
qplot(carat, data = diamonds, geom = "density", colour = color)
qplot(carat, data = diamonds, geom = "histogram", fill = color)
qplot(carat, data = diamonds, geom = "histogram", fill = color, binwidth = 0.1, xlim = c(0,3))
qplot(price, data = diamonds, geom = "histogram", fill = color, binwidth = 0.1, xlim = c(0,3))
qplot(price, data = diamonds, geom = "histogram")
qplot(price, data = diamonds, geom = "histogram", bidwidth = 100)
qplot(price, data = diamonds, geom = "histogram", binwidth = 100)
qplot(price, data = diamonds, geom = "histogram", binwidth = 100, fill = color)
qplot(color, data = diamonds, geom = "bar")
qplot(color, data = diamonds, geom = "bar", weight = carat)+scale_y_continuous("carat")
qplot(carat, data = diamonds, facets ~ ., geom = "histogram", binwidth = 0.1, xlim = c(0, 3))
qplot(carat, data = diamonds, facets = color  ~ ., geom = "histogram", binwidth = 0.1, xlim = c(0, 3))
422810/3053021
?round
round( (422810/3053021)*100 , 1)
round( (422810/3053021)*100 , 2)
(422810/3053021)*100
round( (422810/3053021)*100 , 0)
round( (2014790/3053021)*100 , 0)
round( (615421/3053021)*100 , 0)
round( (307725/2858376)*100 , 0)
round( (397638/4356208)*100 , 0)
round( (3317977/4356208)*100 , 0)
round( (291638/4048889)*100 , 0)
round( (3423977/4048889)*100 , 0)
round( (333274/4048889)*100 , 0)
round( (226694/2526088)*100 , 0)
round( (311047/2751465)*100 , 0)
round( (590601/3143471)*100 , 0)
round( (438982/2985360)*100 , 0)
round( (554855/4457232)*100 , 0)
round( (230623/1906609)*100 , 0)
round( (1398455/1906609)*100 , 0)
round( (277531/1906609)*100 , 0)
round( (300227/3283629)*100 , 0)
round( (2775475/3283629)*100 , 0)
round( (207927/3283629)*100 , 0)
round( (316585/2396947)*100 , 0)
round( (1888793/2396947)*100 , 0)
round( (191569/2396947)*100 , 0)
round( (322074/2269293)*100 , 0)
round( (1703826/2269293)*100 , 0)
round( (243393/2269293)*100 , 0)
round( (233629/1758655)*100 , 0)
round( (1193188/1758655)*100 , 0)
round( (331838/1758655)*100 , 0)
round( (306427/2723416)*100 , 0)
round( (2157949/2723416)*100 , 0)
round( (259040/2723416)*100 , 0)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
data <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562HotspotsRep1.bed")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
data <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562HotspotsRep1.bed")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
data <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562HotspotsRep1.bed")
ncol(data)
nrow(data)
nrow(data)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
data <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562HotspotsRep1.bed")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
data <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562HotspotsRep1.bed")
is.data.frame(data)
names(data)
qplot(start, data = data, geom = "histogram")
qplot(start, data = data, geom = "histogram", binwidth = 10000)
qplot(start, data = data, geom = "histogram", binwidth = 100000)
qplot(start, data = data, geom = "histogram", binwidth = 1000000)
qplot(start, data = data, geom = "histogram", binwidth = 1000000, fill = strand)
qplot(start, data = data, geom = "histogram", binwidth = 1000000)
qplot(end-start/2, data = data, geom = "histogram", binwidth = 1000000)
qplot(end-start/2, data = data, geom = "histogram", binwidth = 100000)
qplot((end-start)/2, data = data, geom = "histogram", binwidth = 100000)
data$end-data$start
qplot((end-start)/2+start, data = data, geom = "histogram", binwidth = 100000)
qplot((end-start)/2+start, data = data, geom = "histogram", binwidth = 1000000)
qplot((end-start)/2+start, data = data, geom = "histogram", binwidth = 10000000)
qplot((end-start)/2+start, data = data, geom = "histogram", binwidth = 10000)
min(data$start)
qplot((end-start)/2+start, data = data, geom = "histogram", binwidth = 10000, xlim = c(16197787, 50000000))
E_data <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562HotspotsRep1.bed")
names(E_data)
E_data[1,1]
E_data[1,2]
E_data[1,3]
E_data[1,4]
E_data[,4]<- "E"
E_data[1,4]
E_data[2,4]
A_data bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562/group_A_hotspots.bed")
A_data <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562/group_A_hotspots.bed")
dim(A_data)
x = seq(1:5)
x
?seq
?rep
rep("x", 5)
T = rep("A", 5)
T
L= seq(1:5)
dummy = data.frame(L = L, T = T)
namees(dummy)
names(dummy)
dummy$T
B_databed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562/group_B_hotspots.bed")
B_data<- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/K562/group_B_hotspots.bed")
names(B_data)
starts = c(E_datat$starts, A_data$starts, B_data$starts)
starts = c(E_data$starts, A_data$starts, B_data$starts)
length(starts)
starts[1]
E_data$starts[1]
A_data$starts[1]
names(E_data)
starts = c(E_data$start, A_data$start, B_data$start)
length(starts)
ends = c(E_data$end, A_data$end, B_data$end)
length(ends)
length(E_data$start)
length(A_data$start)
length(B_data$start)
Names = c(rep("E", length(E_data$start)), rep("A", length(A_data$start)), rep("B", length(B_data$start))   )
length(Names)
DF = data.frame(Starts = Starts, Ends = Ends, Names = Names)
DF = data.frame(starts = starts, ends = ends, Names = Names)
qplot(starts, data = DF, geom = "histogram", fill = Names)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data)
distribution.of.hotspost(E_data, A_data, B_data, 1000000)
min(c(E_data$start, A_data$start, B_data$start))
max(c(E_data$end, A_data$end, B_data$end))
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 1000000)
distribution.of.hotspost(E_data, A_data, B_data, 1000000, alpha = I(1/20))
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 1000000)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 1000000)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 1000000)
distribution.of.hotspost(E_data, A_data, B_data, 100000)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 100000)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 100000)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 100000)
distribution.of.hotspost(E_data, A_data, B_data, 100000, "K562")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 100000, "K562")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 100000, "K562")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 100000, "K562")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 100000, "K562")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_data, A_data, B_data, 100000, "K562")
?qplot
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
?qplot
library(plyr)
library(ggplot2)
library(reshape2)
H1hescPol2V0416102PkRep1.chr22.broadPeak <- bed.as.data.frame("/nfs/th_group/hk3/POLII/H1hesc/wgEncodeHaibTfbsH1hescPol2V0416102PkRep1_chr22.broadPeak")
names(H1hescPol2V0416102PkRep1.chr22.broadPeak)
qplot(end-start, score, data = H1hescPol2V0416102PkRep1.chr22.broadPeak)
qplot(end-start, score, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom = c("point", "smooth"))
qplot(end-start, score, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom = c("point", "smooth"), xlab = "length of PolII braod peaks")
qplot(end-start, score, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom = c("point", "smooth"), xlab = "lengths of PolII braod peaks", main = "score vs length of peaks in H1hescPol2V0416102PkRep1")
Max <- max(H1hescPol2V0416102PkRep1.chr22.broadPeak$end)
Max
Min <- min(H1hescPol2V0416102PkRep1.chr22.broadPeak$start)
Min
Sum <- sum(H1hescPol2V0416102PkRep1.chr22.broadPeak$end - H1hescPol2V0416102PkRep1.chr22.broadPeak$start)
Sum
Coverage <- Sum/(Max-Min)
Coverage
round(Coverage*100,0)
?save
qplot(end-start, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom =  "histogram")
qplot(end-start, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom =  "histogram", binwidth = 100)
qplot(end-start, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom =  "histogram", binwidth = 100, colour = "blue")
qplot(score, thickStart, data = H1hescPol2V0416102PkRep1.chr22.broadPeak)
qplot(end-start, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom =  "histogram", binwidth = 100)
qplot(end-start, data = H1hescPol2V0416102PkRep1.chr22.broadPeak, geom =  "histogram", binwidth = 100, fill = "blue")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100)
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "blue")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "blue", fill = "red")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white", xlab = "lengths")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white", xlab = "lengths")+ scale_x_continous(name = "lengths")
ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white", xlab = "lengths")+ scale_x_continuous(name = "lengths")
pol_II_lengths <- ggplot(H1hescPol2V0416102PkRep1.chr22.broadPeak, aes(x = end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white", xlab = "lengths")+ scale_x_continuous(name = "lengths")
pol_II_lengths + opts(title = "Pol II")
E_df <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc/wgEncodeUwDnaseH1hescHotspotsRep1.bed")
A_df <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc/group_A_hotspots.bed")
B_df <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc/group_B_hotspots.bed")
E_Lengths <- ggplot(E_df, aes(x= end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white")+scale_x_continuous("name = lengths")
E_Lengths
E_Lengths <- ggplot(E_df, aes(x= end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white")+scale_x_continuous("name = lengths")+ opts(title = "lengths of E hotspots")
A_Lengths <- ggplot(A_df, aes(x= end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white")+scale_x_continuous("name = lengths")+ opts(title = "lengths of A hotspots")
A_Lengths
B_Lengths <- ggplot(B_df, aes(x= end-start))+geom_histogram(binwidth =100, colour = "black", fill = "white")+scale_x_continuous("name = lengths")+ opts(title = "lengths of B hotspots")
B_Lengths
multiplot(pol_II_lengths, E_Lengths, A_Lengths, B_Lengths, cols = 2)
library(ggplot2)
multiplot(pol_II_lengths, E_Lengths, A_Lengths, B_Lengths, cols = 2)
multiplot <- function(..., plotlist=NULL, cols) {
    require(grid)
    # Make a list from the ... arguments and plotlist
    plots <- c(list(...), plotlist)
    numPlots = length(plots)
    # Make the panel
    plotCols = cols                          # Number of columns of plots
    plotRows = ceiling(numPlots/plotCols) # Number of rows needed, calculated from # of cols
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(plotRows, plotCols)))
    vplayout <- function(x, y)
        viewport(layout.pos.row = x, layout.pos.col = y)
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
        curRow = ceiling(i/plotCols)
        curCol = (i-1) %% plotCols + 1
        print(plots[[i]], vp = vplayout(curRow, curCol ))
    }
}
multiplot(pol_II_lengths, E_Lengths, A_Lengths, B_Lengths, cols = 2)
multiplot(pol_II_lengths+opts(title = "Pol II"), E_Lengths, A_Lengths, B_Lengths, cols = 2)
multiplot(pol_II_lengths+opts(title = "Lengths of Pol II"), E_Lengths, A_Lengths, B_Lengths, cols = 2)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_df,A_df, B_df, binWidth = 10000, "H1hesc")
distribution.of.hotspost(E_df,A_df, B_df, 10000, "H1hesc")
distribution.of.hotspost(E_df,A_df, B_df, 100000, "H1hesc")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_df,A_df, B_df, 100000, "H1hesc")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_df,A_df, B_df, 100000, "H1hesc")
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
distribution.of.hotspost(E_df,A_df, B_df, 100000, "H1hesc")
choose(100,4)
choose(50000000,30000000)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
Tabel <- get.table("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562AlnRep1_chr22_biasness_scores_Real_PWM.txt")
Tabel <- get.table("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562AlnRep1_chr22_biasness_scores_Real_PWM.txt", ",")
dim(Table)
Table <- get.table("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562AlnRep1_chr22_biasness_scores_Real_PWM.txt", ",")
dim(Table)
Table
Table[1,1]
nrows(Table)
nrow(Table)
ncol(Table)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
dim(PWM)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
PWM <- draw.pwm(Table)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
PWM
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
PWM
PWM <- draw.pwm(Table)
dim(PWM)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
dim(PWM)
M <- melt(pwm,varnames = c("nt", "pos")), aes(x= pos,y= value, label = nt)
M <- melt(PWM,varnames = c("nt", "pos")), aes(x= pos,y= value, label = nt))
M <- melt(PWM,varnames = c("nt", "pos"))
M
PWM
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
PWM
M <- melt(PWM,varnames = c("nt", "pos"))
M
p<- ggplot(M, aes(x=pos, y = value,label= nt) )
p+geom_abline( aes(colour= factor(nt)) )
qplot(x=pos, y= value, label = nt, data = M)
p+geom_abline( aes(slope=0) , colour= "grey", size=2 )
p+geom_abline( aes(slope=0) , colour= "grey", size=2 )+ geom_text(aes(colour=factor(nt)),size=8)
source("/nfs/users/nfs_h/hk3/My_R_Scripts/some_handy_functions.r")
PWM <- draw.pwm(Table)
PWM
TABLE_BACKGROUND <- get.table("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562AlnRep1_chr22_biasness_scores_BG_PWM.txt")
TABLE_BACKGROUND <- get.table("/nfs/th_group/hk3/UW_DNaseI_HS/K562/wgEncodeUwDnaseK562AlnRep1_chr22_biasness_scores_BG_PWM.txt",",")
PWM_BG <- draw.pwm(TABLE_BACKGROUND)
PWM_BG
PWM_BG+ylim(-1,1)
PWM
PWM +ylim(-1, 0.5)
PWM
PWM +ylim(-1.2, 0.5)
PWM_BG+ylim(-1.2, 0.5)
PWM_BG+ylim(-1.2, 0.5)+main("Main")
multiplot(bp + opts(title="Plant growth"))
bp + opts(title="Plant growth")
multiplot(PWM +ylim(-1.2, 0.5)+ opts(title="Biased Model"), PWM_BG+ylim(-1.2, 0.5) + opts(title= "Background Model"), cols=2)
multiplot(PWM +ylim(-1.2, 0.5)+ opts(title="Biased Model")+ scale_y_continuous(name="Log relative frequency"), PWM_BG+ylim(-1.2, 0.5) + opts(title= "Background Model")+  scale_y_continuous(name="Log relative frequency"), cols=2)
PWM_BG <- PWM_BG+ylim(-1.2, 0.5)+ scale_y_continuous(name="Log relative frequency")
PWM_BG <- PWM_BG+ylim(-1.2, 0.5)+ scale_y_continuous(name="Log relative frequency")+ opts(title= "Background Model")
PWM +ylim(-1.2, 0.5)+ scale_y_continuous(name="Log relative frequency")+ opts(title="Biased Model")
PWM <-PWM +ylim(-1.2, 0.5)+ scale_y_continuous(name="Log relative frequency")+ opts(title="Biased Model")
multiplot(PWM, PWM_BG, cols=2)
PWM<-PWM +scale_y_continuous(name="Log relative frequency", limits=c(-1.2,0.5))+ opts(title="Biased Model")
PWM_BG <- PWM_BG+ scale_y_continuous(name="Log relative frequency", limits = c(-1.2,05))+ opts(title= "Background Model")
multiplot(PWM, PWM_BG, cols=2)
PWM_BG <- PWM_BG+ scale_y_continuous(name="Log relative frequency", limits = c(-1.2,0.5))+ opts(title= "Background Model")
multiplot(PWM, PWM_BG, cols=2)
PWM_BG <- PWM_BG+ scale_y_continuous(name="Log relative frequency", limits = c(-1.2,0.5))+ opts(title= "Background Model",legend.position="none")
PWM_BG <- PWM_BG+ scale_y_continuous(name="Log relative frequency", limits = c(-1.2,0.5))+ opts(title= "Background Model",legend.position="none")
multiplot(PWM, PWM_BG, cols=2)
distribution.of.hotspost(E_df,A_df, B_df, 10000, "H1hesc")
distribution.of.hotspost(E_df,A_df, B_df, 1000, "H1hesc")
distribution.of.hotspost(E_df,A_df, B_df, 100000, "H1hesc")
round( (405785/2462469)*100, 0 )
round( (1424238/2462469)*100, 0 )
round( (632446/2462469)*100, 0 )
round( (297999/2156936)*100, 0 )
round( (1532024/2156936)*100, 0 )
round( (326913/2156936)*100, 0 )
round( (560729/2565766)*100, 0 )
round( (1269294/2565766)*100, 0 )
round( (735743/2565766)*100, 0 )
E_df_Long <- bed.as.data.frame("/nfs/th_group/hk3/UW_DNaseI_HS/H1hesc/wgEncodeUwDnaseH1hescHotspotsRep1_not_shorter_than_200.bed")
distribution.of.hotspost(E_df_Long,A_df, B_df, 10000, "H1hesc")
distribution.of.hotspost(E_df_Long,A_df, B_df, 1000, "H1hesc")
distribution.of.hotspost(E_df_Long,A_df, B_df, 10000, "H1hesc")
distribution.of.hotspost(E_df_Long,A_df, B_df, 100000, "H1hesc")
